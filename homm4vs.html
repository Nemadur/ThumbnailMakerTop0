<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-latest.min.js"></script>
		<link rel="stylesheet" href="./mainstyle.css">
        <script src="./resources/scripts/sorting.js"></script>

        <style>
            .fileSelect{
                margin: auto;
                margin-top: 20px;
                width: 50%;
            }
        </style>

        <script>

            $(document).ready(function() {
                $('#toSort').tablesort()
            });

			var audio = new Audio("./resources/audio/top_0_Wasu.wav");
			
            const imageHeight = 650;
            const imageWidth = 460;
            const textStart = 930;
            const positions = [[450, 270], [695, 270]]
            const iconSize = 140;

            function generateThumbnails() {
				audio.play();
				document.querySelector("#main").innerHTML = "";

                const icons = document.querySelector('#fileItems');
                const background = document.createElement('img')
                background.src = './resources/img/H4Background.png'

                const newThumbnail = document.createElement('canvas')
                newThumbnail.width = 1280
                newThumbnail.height = 720

                const ctx = newThumbnail.getContext("2d");
            
                ctx.drawImage(background, 0, 0);

                for (let index = 0; index < icons.files.length; index++) {
                    var file = icons.files.item(index);
                    
                    var reader = new FileReader();
                    reader.onload = function(event) {
                        var iconImg = document.createElement('img');
                        iconImg.src = event.target.result;

                        const [x, y] = positions[index]

                        iconImg.addEventListener("load", () => {
                            ctx.drawImage(iconImg, x, y, iconSize, iconSize);
                        });

                    };
                    reader.readAsDataURL(file);
                }

                const tableRow = document.createElement('tr');
                const tableCell  = document.createElement('td');
                const idCell  = document.createElement('td');

                tableCell.appendChild(newThumbnail)
                tableRow.appendChild(idCell)
                tableRow.appendChild(tableCell)

                document.getElementById('main').appendChild(tableRow)
            }

        </script>

    </head>
    <body>
        <div>
            
            <div class="mb-3 fileSelect">
                <label for="fileItems" class="form-label">Pliki avatar√≥w</label>
                <input class="form-control" type="file" id="fileItems" multiple>
            </div>
			
            
            <div class="mb-3 fileSelect">
                <button onclick="generateThumbnails()" type="button" class="btn btn-primary" style="width: 100%;">Generuj #wc3 Thumbnail</button>
            </div>

        </div>

        <table id="toSort" class="sortable table">
            <thead>
                <tr>
                  <th>id</th>
                  <th>Thumbnail</th>
                </tr>
              </thead>
              <tbody id="main">

              </tbody>
        </table>

    </body>
</html>